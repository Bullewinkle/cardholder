(function() {
  var __slice = [].slice;

  this.app.module('CardGenerator.generators.textGen', function(TextGen) {
    this.options = {};
    return this.draw = function() {
      var args, canvas, cardData, context, eMail, fontFamily, fontsList, model, name, newData, options, phone, position, randomFont, randomFontNumber, randomNameNum, randomPhoneEnd, renderInitials, renderText, sex, srcData, surname, textAlign, textAligns;
      canvas = arguments[0], model = arguments[1], args = 3 <= arguments.length ? __slice.call(arguments, 2) : [];
      options = model.get('generators.' + this.name);
      cardData = model.get('data');
      srcData = app.data.attributes;
      name = model.get('data.name');
      surname = model.get('data.surname');
      sex = model.get('data.sex');
      phone = model.get('data.phone');
      eMail = model.get('data.eMail');
      position = model.get('data.position');
      textAligns = ['left', 'center', 'right'];
      textAlign = options.textAlign;
      fontsList = app.data.get('fontsList');
      fontFamily = options.fontFamily;
      context = canvas.getContext('2d');
      renderText = function(fontFamily) {
        var font, paragrafHeight, wrapText, x, y;
        if (fontFamily === 'sans-serif') {
          font = fontFamily;
        } else {
          font = '"' + fontFamily + '"';
        }
        switch (textAlign) {
          case 'left':
            x = 10;
            y = 20;
            break;
          case 'center':
            x = canvas.width / 2;
            y = 20;
            break;
          case 'right':
            x = canvas.width - 10;
            y = 20;
        }
        paragrafHeight = 0;
        wrapText = function(context, text, x, y, maxWidth, lineHeight) {
          var line, linesCounter, metrics, testLine, testWidth, word, words, _i, _len;
          words = text.split(' ');
          line = '';
          linesCounter = 0;
          for (_i = 0, _len = words.length; _i < _len; _i++) {
            word = words[_i];
            linesCounter = _i + 1;
            testLine = line + word + ' ';
            metrics = context.measureText(testLine);
            testWidth = metrics.width;
            if (testWidth > maxWidth && _i > 0) {
              context.fillText(line, x, y);
              line = word + ' ';
              y += lineHeight;
            } else {
              line = testLine;
            }
            paragrafHeight = y;
          }
          return context.fillText(line, x, y);
        };
        context.font = '1.5em ' + font;
        context.textAlign = textAlign;
        context.fillStyle = '#000';
        context.textBaseline = 'middle';
        context.lineWidth = 1.5;
        wrapText(context, renderInitials(name, surname), x, y, canvas.width - 20, 28);
        context.font = '0.8em ' + font;
        if (textAlign === 'right') {
          x -= 5;
        }
        context.fillText('тел.: ' + phone, x, 32 + paragrafHeight);
        context.fillText('email: ' + eMail, x, 49 + paragrafHeight);
        if (textAlign === 'right') {
          x += 5;
        }
        wrapText(context, position, x, 66 + paragrafHeight, canvas.width - 20, 18);
        return context.save();
      };
      renderInitials = function(name, surname) {
        if (sex === 'male') {
          surname = surname;
        } else if (sex === 'female') {
          if (surname.substr(surname.length - 2, surname.length) === 'ий') {
            surname = surname.slice(0, surname.length - 2);
            surname = surname + 'ая';
          } else {
            surname = surname + 'a';
          }
        }
        return name + ' ' + surname;
      };
      if (cardData.defaultData) {
        newData = {};
        randomNameNum = app.getRandom(0, srcData.names.length - 1);
        name = srcData.names[randomNameNum].text;
        newData.name = name;
        sex = srcData.names[randomNameNum].sex;
        newData.sex = sex;
        surname = srcData.surnames[app.getRandom(0, srcData.surnames.length - 1)];
        newData.surname = surname;
        randomPhoneEnd = app.getRandom(0, srcData.names.length - 1);
        if (('' + randomPhoneEnd).length < 2) {
          randomPhoneEnd = '0' + randomPhoneEnd;
        }
        phone = '+7-' + srcData.phones + randomPhoneEnd;
        newData.phone = phone;
        eMail = srcData.emails[app.getRandom(0, srcData.emails.length - 1)];
        newData.eMail = eMail;
        position = srcData.positions[app.getRandom(0, srcData.positions.length - 1)];
        newData.position = position;
        newData.defaultData = false;
        model.set('data', newData, {
          silent: true
        });
      }
      if (options.defaultOptions) {
        textAlign = textAligns[app.getRandom(0, textAligns.length - 1)];
        model.set('generators.' + this.name + '.textAlign', textAlign, {
          silent: true
        });
        randomFontNumber = app.getRandom(0, app.data.get('fontsList'.length - 1));
        randomFont = app.data.get('fontsList');
        fontFamily = '' + randomFont[randomFontNumber];
        WebFont.load({
          custom: {
            families: [fontFamily],
            urls: ['/assets/font/card_fonts/' + fontFamily + '/' + fontFamily + '.css']
          },
          active: (function(_this) {
            return function() {
              renderText(fontFamily);
              return model.set('generators.' + _this.name + '.fontFamily', fontFamily, {
                silent: true
              });
            };
          })(this),
          loading: (function(_this) {
            return function() {};
          })(this),
          fontloading: (function(_this) {
            return function() {};
          })(this),
          fontactive: (function(_this) {
            return function() {};
          })(this),
          inactive: (function(_this) {
            return function() {
              renderText(model.defaults.generators[_this.name].fontFamily);
              return console.log('INACTIVE FONT : ' + fontFamily);
            };
          })(this),
          fontinactive: (function(_this) {
            return function() {};
          })(this)
        });
      } else {
        renderText(fontFamily);
      }
      return model.set('generators.' + this.name + '.defaultOptions', false, {
        silent: true
      });
    };
  });

}).call(this);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNhcmRzX2dlbmVyYXRvci9nZW5lcmF0b3JzL3RleHQtZ2VuZXJlYXRvci5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQSxNQUFBLGtCQUFBOztBQUFBLEVBQUEsSUFBQyxDQUFBLEdBQUcsQ0FBQyxNQUFMLENBQVksa0NBQVosRUFBZ0QsU0FBQyxPQUFELEdBQUE7QUFFL0MsSUFBQSxJQUFDLENBQUEsT0FBRCxHQUFXLEVBQVgsQ0FBQTtXQUVBLElBQUMsQ0FBQSxJQUFELEdBQVEsU0FBQSxHQUFBO0FBQ1AsVUFBQSxvUEFBQTtBQUFBLE1BRFEsdUJBQU8sc0JBQU0sOERBQ3JCLENBQUE7QUFBQSxNQUFBLE9BQUEsR0FBVSxLQUFLLENBQUMsR0FBTixDQUFVLGFBQUEsR0FBZ0IsSUFBQyxDQUFBLElBQTNCLENBQVYsQ0FBQTtBQUFBLE1BQ0EsUUFBQSxHQUFXLEtBQUssQ0FBQyxHQUFOLENBQVUsTUFBVixDQURYLENBQUE7QUFBQSxNQUdBLE9BQUEsR0FBVSxHQUFHLENBQUMsSUFBSSxDQUFDLFVBSG5CLENBQUE7QUFBQSxNQUtBLElBQUEsR0FBTyxLQUFLLENBQUMsR0FBTixDQUFVLFdBQVYsQ0FMUCxDQUFBO0FBQUEsTUFNQSxPQUFBLEdBQVUsS0FBSyxDQUFDLEdBQU4sQ0FBVSxjQUFWLENBTlYsQ0FBQTtBQUFBLE1BT0EsR0FBQSxHQUFNLEtBQUssQ0FBQyxHQUFOLENBQVUsVUFBVixDQVBOLENBQUE7QUFBQSxNQVFBLEtBQUEsR0FBUSxLQUFLLENBQUMsR0FBTixDQUFVLFlBQVYsQ0FSUixDQUFBO0FBQUEsTUFTQSxLQUFBLEdBQVEsS0FBSyxDQUFDLEdBQU4sQ0FBVSxZQUFWLENBVFIsQ0FBQTtBQUFBLE1BVUEsUUFBQSxHQUFXLEtBQUssQ0FBQyxHQUFOLENBQVUsZUFBVixDQVZYLENBQUE7QUFBQSxNQVlBLFVBQUEsR0FBYSxDQUFDLE1BQUQsRUFBUSxRQUFSLEVBQWlCLE9BQWpCLENBWmIsQ0FBQTtBQUFBLE1BYUEs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QUFBO21CQUFBLFNBQUEsR0FBQSxFQUFBO1VBQUEsQ0FBQSxDQUFBLENBQUEsSUFBQSxDQVRaO0FBQUEsVUFVQSxRQUFBLEVBQVUsQ0FBQSxTQUFBLEtBQUEsR0FBQTttQkFBQSxTQUFBLEdBQUE7QUFDVCxjQUFBLFVBQUEsQ0FBWSxLQUFLLENBQUMsUUFBUSxDQUFDLFVBQVksQ0FBQSxLQUFDLENBQUEsSUFBRCxDQUFPLENBQUMsVUFBL0MsQ0FBQSxDQUFBO3FCQUNBLE9BQU8sQ0FBQyxHQUFSLENBQVksa0JBQUEsR0FBcUIsVUFBakMsRUFGUztZQUFBLEVBQUE7VUFBQSxDQUFBLENBQUEsQ0FBQSxJQUFBLENBVlY7QUFBQSxVQWFBLFlBQUEsRUFBYyxDQUFBLFNBQUEsS0FBQSxHQUFBO21CQUFBLFNBQUEsR0FBQSxFQUFBO1VBQUEsQ0FBQSxDQUFBLENBQUEsSUFBQSxDQWJkO1NBRkQsQ0FSQSxDQUZEO09BQUEsTUFBQTtBQTZCQyxRQUFBLFVBQUEsQ0FBVyxVQUFYLENBQUEsQ0E3QkQ7T0FwSEE7YUFtSkEsS0FBSyxDQUFDLEdBQU4sQ0FBVSxhQUFBLEdBQWMsSUFBQyxDQUFBLElBQWYsR0FBb0IsaUJBQTlCLEVBQWlELEtBQWpELEVBQ0M7QUFBQSxRQUFBLE1BQUEsRUFBUSxJQUFSO09BREQsRUFwSk87SUFBQSxFQUp1QztFQUFBLENBQWhELENBQUEsQ0FBQTtBQUFBIiwiZmlsZSI6ImNhcmRzX2dlbmVyYXRvci9nZW5lcmF0b3JzL3RleHQtZ2VuZXJlYXRvci5qcyIsInNvdXJjZVJvb3QiOiIvc291cmNlLyIsInNvdXJjZXNDb250ZW50IjpbIkBhcHAubW9kdWxlICdDYXJkR2VuZXJhdG9yLmdlbmVyYXRvcnMudGV4dEdlbicsIChUZXh0R2VuKSAtPlxuXG5cdEBvcHRpb25zID0ge31cblxuXHRAZHJhdyA9IChjYW52YXMsbW9kZWwsYXJncy4uLikgLT5cblx0XHRvcHRpb25zID0gbW9kZWwuZ2V0ICdnZW5lcmF0b3JzLicgKyBAbmFtZVxuXHRcdGNhcmREYXRhID0gbW9kZWwuZ2V0ICdkYXRhJ1xuXG5cdFx0c3JjRGF0YSA9IGFwcC5kYXRhLmF0dHJpYnV0ZXNcblxuXHRcdG5hbWUgPSBtb2RlbC5nZXQgJ2RhdGEubmFtZSdcblx0XHRzdXJuYW1lID0gbW9kZWwuZ2V0ICdkYXRhLnN1cm5hbWUnXG5cdFx0c2V4ID0gbW9kZWwuZ2V0ICdkYXRhLnNleCdcblx0XHRwaG9uZSA9IG1vZGVsLmdldCAnZGF0YS5waG9uZSdcblx0XHRlTWFpbCA9IG1vZGVsLmdldCAnZGF0YS5lTWFpbCdcblx0XHRwb3NpdGlvbiA9IG1vZGVsLmdldCAnZGF0YS5wb3NpdGlvbidcblxuXHRcdHRleHRBbGlnbnMgPSBbJ2xlZnQnLCdjZW50ZXInLCdyaWdodCddXG5cdFx0dGV4dEFsaWduID0gb3B0aW9ucy50ZXh0QWxpZ25cblx0XHRmb250c0xpc3QgPSBhcHAuZGF0YS5nZXQgJ2ZvbnRzTGlzdCdcblx0XHRmb250RmFtaWx5ID0gb3B0aW9ucy5mb250RmFtaWx5XG5cblx0XHRjb250ZXh0ID0gY2FudmFzLmdldENvbnRleHQoJzJkJylcblxuXHRcdHJlbmRlclRleHQgPSAoZm9udEZhbWlseSkgLT5cblx0XHRcdGlmIGZvbnRGYW1pbHkgaXMgJ3NhbnMtc2VyaWYnXG5cdFx0XHRcdGZvbnQgPSBmb250RmFtaWx5XG5cdFx0XHRlbHNlIFxuXHRcdFx0XHRmb250ID0gJ1wiJytmb250RmFtaWx5KydcIidcblx0XHRcdHN3aXRjaCB0ZXh0QWxpZ25cblx0XHRcdFx0d2hlbiAnbGVmdCdcblx0XHRcdFx0XHR4ID0gMTBcblx0XHRcdFx0XHR5ID0gMjBcblx0XHRcdFx0d2hlbiAnY2VudGVyJyBcblx0XHRcdFx0XHR4ID0gY2FudmFzLndpZHRoLzJcblx0XHRcdFx0XHR5ID0gMjBcblx0XHRcdFx0d2hlbiAncmlnaHQnXG5cdFx0XHRcdFx0eCA9IGNhbnZhcy53aWR0aC0xMFxuXHRcdFx0XHRcdHkgPSAyMCBcblx0XHRcdHBhcmFncmFmSGVpZ2h0ID0gMFxuXHRcdFx0XG5cdFx0XHR3cmFwVGV4dCA9IChjb250ZXh0LCB0ZXh0LCB4LCB5LCBtYXhXaWR0aCwgbGluZUhlaWdodCkgLT5cblx0XHRcdFx0d29yZHMgPSB0ZXh0LnNwbGl0KCcgJylcblx0XHRcdFx0bGluZSA9ICcnXG5cdFx0XHRcdGxpbmVzQ291bnRlciA9IDBcblx0XHRcdFx0Zm9yIHdvcmQgaW4gd29yZHNcblx0XHRcdFx0XHQjIGNvbnNvbGUubG9nIHdvcmQsX2lcblx0XHRcdFx0XHRsaW5lc0NvdW50ZXIgPSBfaSsxXG5cdFx0XHRcdFx0dGVzdExpbmUgPSBsaW5lICsgd29yZCArICcgJ1xuXHRcdFx0XHRcdG1ldHJpY3MgPSBjb250ZXh0Lm1lYXN1cmVUZXh0KHRlc3RMaW5lKVxuXHRcdFx0XHRcdHRlc3RXaWR0aCA9IG1ldHJpY3Mud2lkdGhcblx0XHRcdFx0XHRpZiAgdGVzdFdpZHRoID4gbWF4V2lkdGggYW5kIF9pID4gMFxuXHRcdFx0XHRcdFx0Y29udGV4dC5maWxsVGV4dChsaW5lLCB4LCB5KVxuXHRcdFx0XHRcdFx0bGluZSA9IHdvcmQgKyAnICdcblx0XHRcdFx0XHRcdHkgKz0gbGluZUhlaWdodFxuXHRcdFx0XHRcdGVsc2Vcblx0XHRcdFx0XHRcdGxpbmUgPSB0ZXN0TGluZVxuXHRcdFx0XHRcdHBhcmFncmFmSGVpZ2h0ID0geVxuXHRcdFx0XHRcdFxuXHRcdFx0XHRjb250ZXh0LmZpbGxUZXh0KGxpbmUsIHgsIHkpXG5cdFx0XHRjb250ZXh0LmZvbnQgPSAnMS41ZW0gJyArIGZvbnRcblx0XHRcdGNvbnRleHQudGV4dEFsaWduID0gdGV4dEFsaWduXG5cdFx0XHRjb250ZXh0LmZpbGxTdHlsZSA9ICcjMDAwJ1xuXHRcdFx0Y29udGV4dC50ZXh0QmFzZWxpbmUgPSAnbWlkZGxlJ1xuXHRcdFx0Y29udGV4dC5saW5lV2lkdGggPSAxLjVcblxuXHRcdFx0d3JhcFRleHQgY29udGV4dCAsIHJlbmRlckluaXRpYWxzKG5hbWUsIHN1cm5hbWUpLCB4LCB5LCBjYW52YXMud2lkdGgtMjAsIDI4XG5cblx0XHRcdGNvbnRleHQuZm9udCA9ICcwLjhlbSAnICsgZm9udFxuXHRcdFx0IyBjb25zb2xlLmxvZyAnY2FyZCDihJYnICsgbW9kZWwuZ2V0KCdpZCcpICsgJyA6ICcgKyBmb250LnNwbGl0KCdcIicpLmpvaW4oJycpXG5cdFx0XHRpZiB0ZXh0QWxpZ24gaXMgJ3JpZ2h0JyB0aGVuIHgtPTVcblx0XHRcdGNvbnRleHQuZmlsbFRleHQgJ9GC0LXQuy46ICcgKyBwaG9uZSwgeCwgMzIgK3BhcmFncmFmSGVpZ2h0XG5cdFx0XHRjb250ZXh0LmZpbGxUZXh0ICdlbWFpbDogJysgZU1haWwsIHgsIDQ5ICtwYXJhZ3JhZkhlaWdodFxuXHRcdFx0aWYgdGV4dEFsaWduIGlzICdyaWdodCcgdGhlbiB4Kz01XG5cdFx0XHR3cmFwVGV4dCBjb250ZXh0ICwgcG9zaXRpb24sIHgsIDY2ICsgcGFyYWdyYWZIZWlnaHQsIGNhbnZhcy53aWR0aC0yMCwgMThcblxuXHRcdFx0Y29udGV4dC5zYXZlKClcblxuXHRcdHJlbmRlckluaXRpYWxzID0gKG5hbWUsIHN1cm5hbWUpIC0+XG5cblx0XHRcdGlmIHNleCBpcyAnbWFsZSdcblx0XHRcdFx0c3VybmFtZSA9IHN1cm5hbWVcblxuXHRcdFx0ZWxzZSBpZiBzZXggaXMgJ2ZlbWFsZSdcblx0XHRcdFx0aWYgc3VybmFtZS5zdWJzdHIoc3VybmFtZS5sZW5ndGgtMixzdXJuYW1lLmxlbmd0aCkgaXMgJ9C40LknXG5cdFx0XHRcdFx0c3VybmFtZSA9IHN1cm5hbWUuc2xpY2UoMCxzdXJuYW1lLmxlbmd0aC0yKVxuXHRcdFx0XHRcdHN1cm5hbWUgPSBzdXJuYW1lKyfQsNGPJ1xuXHRcdFx0XHRlbHNlXG5cdFx0XHRcdFx0c3VybmFtZSA9IHN1cm5hbWUrJ2EnIFxuXHRcdFx0bmFtZSArICcgJyArIHN1cm5hbWVcblxuXG5cdFx0aWYgY2FyZERhdGEuZGVmYXVsdERhdGFcblx0XHRcdG5ld0RhdGEgPSB7fVxuXHRcdFx0cmFuZG9tTmFtZU51bSA9IGFwcC5nZXRSYW5kb20oMCwgc3JjRGF0YS5uYW1lcy5sZW5ndGgtMSApXG5cblx0XHRcdG5hbWUgPSAgc3JjRGF0YS5uYW1lc1sgcmFuZG9tTmFtZU51bSBdLnRleHRcblx0XHRcdG5ld0RhdGEubmFtZSA9IG5hbWVcblxuXHRcdFx0c2V4ID0gc3JjRGF0YS5uYW1lc1sgcmFuZG9tTmFtZU51bSBdLnNleFxuXHRcdFx0bmV3RGF0YS5zZXggPSBzZXhcblxuXHRcdFx0c3VybmFtZSA9ICBzcmNEYXRhLnN1cm5hbWVzWyBhcHAuZ2V0UmFuZG9tKDAsIHNyY0RhdGEuc3VybmFtZXMubGVuZ3RoLTEgKSBdXG5cdFx0XHRuZXdEYXRhLnN1cm5hbWUgPSBzdXJuYW1lXG5cblx0XHRcdHJhbmRvbVBob25lRW5kID0gYXBwLmdldFJhbmRvbSgwLCBzcmNEYXRhLm5hbWVzLmxlbmd0aC0xIClcblx0XHRcdGlmICgnJysgcmFuZG9tUGhvbmVFbmQpLmxlbmd0aCA8IDIgXG5cdFx0XHRcdHJhbmRvbVBob25lRW5kID0gJzAnICsgcmFuZG9tUGhvbmVFbmRcblx0XHRcdHBob25lID0gJys3LScgKyBzcmNEYXRhLnBob25lcyArIHJhbmRvbVBob25lRW5kXG5cdFx0XHRuZXdEYXRhLnBob25lID0gcGhvbmVcblxuXHRcdFx0ZU1haWwgPSAgc3JjRGF0YS5lbWFpbHNbIGFwcC5nZXRSYW5kb20oMCwgc3JjRGF0YS5lbWFpbHMubGVuZ3RoLTEgKSBdXG5cdFx0XHRuZXdEYXRhLmVNYWlsID0gZU1haWxcblxuXHRcdFx0cG9zaXRpb24gPSAgc3JjRGF0YS5wb3NpdGlvbnNbIGFwcC5nZXRSYW5kb20oMCwgc3JjRGF0YS5wb3NpdGlvbnMubGVuZ3RoLTEgKSBdXG5cdFx0XHRuZXdEYXRhLnBvc2l0aW9uID0gcG9zaXRpb25cblxuXHRcdFx0bmV3RGF0YS5kZWZhdWx0RGF0YSA9IGZhbHNlXG5cdFx0XHRtb2RlbC5zZXQgJ2RhdGEnLCBuZXdEYXRhLFxuXHRcdFx0XHRzaWxlbnQ6IHRydWVcblxuXHRcdGlmIG9wdGlvbnMuZGVmYXVsdE9wdGlvbnNcblxuXHRcdFx0dGV4dEFsaWduID0gdGV4dEFsaWduc1thcHAuZ2V0UmFuZG9tKDAsdGV4dEFsaWducy5sZW5ndGgtMSldXG5cdFx0XHRtb2RlbC5zZXQgJ2dlbmVyYXRvcnMuJytAbmFtZSsnLnRleHRBbGlnbicsIHRleHRBbGlnbixcblx0XHRcdFx0c2lsZW50OiB0cnVlXG5cdFx0XHRyYW5kb21Gb250TnVtYmVyID0gYXBwLmdldFJhbmRvbSgwLGFwcC5kYXRhLmdldCAnZm9udHNMaXN0JyAubGVuZ3RoLTEpXG5cdFx0XHRyYW5kb21Gb250ID0gYXBwLmRhdGEuZ2V0ICdmb250c0xpc3QnXG5cdFx0XHRmb250RmFtaWx5ID0gJycrIHJhbmRvbUZvbnRbcmFuZG9tRm9udE51bWJlcl1cblxuXHRcdFx0IyBMb2FkIGZvbnRzIGRpbmFtaWNhbHkgdGhyb3VnaCBnb29nbGUgd2ViIGxvYWRlclxuXHRcdFx0V2ViRm9udC5sb2FkXG5cblx0XHRcdFx0Y3VzdG9tOlxuXHRcdFx0XHRcdGZhbWlsaWVzOiBbZm9udEZhbWlseV1cblx0XHRcdFx0XHR1cmxzOiBbJy9hc3NldHMvZm9udC9jYXJkX2ZvbnRzLycgKyBmb250RmFtaWx5ICsgJy8nICsgZm9udEZhbWlseSArICcuY3NzJ11cblx0XHRcdFx0YWN0aXZlOiA9PlxuXHRcdFx0XHRcdHJlbmRlclRleHQoZm9udEZhbWlseSlcblx0XHRcdFx0XHRtb2RlbC5zZXQgJ2dlbmVyYXRvcnMuJyArIEBuYW1lICsgJy5mb250RmFtaWx5JywgZm9udEZhbWlseSxcblx0XHRcdFx0XHRcdHNpbGVudDogdHJ1ZVxuXHRcdFx0XHRsb2FkaW5nOiA9PlxuXHRcdFx0XHRmb250bG9hZGluZzogPT5cblx0XHRcdFx0Zm9udGFjdGl2ZTogPT5cblx0XHRcdFx0aW5hY3RpdmU6ID0+XHRcblx0XHRcdFx0XHRyZW5kZXJUZXh0KCBtb2RlbC5kZWZhdWx0cy5nZW5lcmF0b3JzWyBAbmFtZSBdLmZvbnRGYW1pbHkgKVxuXHRcdFx0XHRcdGNvbnNvbGUubG9nICdJTkFDVElWRSBGT05UIDogJyArIGZvbnRGYW1pbHlcblx0XHRcdFx0Zm9udGluYWN0aXZlOiA9PlxuXG5cdFx0XG5cdFx0ZWxzZVxuXHRcdFx0cmVuZGVyVGV4dChmb250RmFtaWx5KVxuXG5cdFx0bW9kZWwuc2V0ICdnZW5lcmF0b3JzLicrQG5hbWUrJy5kZWZhdWx0T3B0aW9ucycsIGZhbHNlLFxuXHRcdFx0c2lsZW50OiB0cnVlIl19