(function() {
  var __slice = [].slice;

  this.app.module('CardGenerator.generators.textGen', function(TextGen, app, Backbone, Marionette, $, _) {
    return this.draw = function() {
      var args, canvas, cardData, context, eMail, fontFamily, fontsList, generateRandomCardInfo, model, name, phone, position, randomCardInfo, randomNameNum, randomPhoneEnd, renderInitials, renderText, sex, srcData, surname, textAlign, textOptions;
      canvas = arguments[0], model = arguments[1], args = 3 <= arguments.length ? __slice.call(arguments, 2) : [];
      srcData = app.CardGenerator.data.get('appdata');
      srcData.textAligns = ['left', 'center', 'right'];
      fontsList = app.CardGenerator.data.get('fontsList');
      textOptions = model.get('generators.textGen');
      cardData = model.get('data');
      name = cardData.name;
      surname = cardData.surname;
      sex = cardData.sex;
      phone = cardData.phone;
      eMail = cardData.eMail;
      position = cardData.position;
      textAlign = textOptions.textAlign;
      fontFamily = textOptions.fontFamily;
      context = canvas.getContext('2d');
      renderText = function(fontFamily) {
        var font, paragrafHeight, wrapText, x, y;
        console.log('render');
        fontFamily = 'sans-serif';
        if (fontFamily === 'sans-serif') {
          font = fontFamily;
        } else {
          font = '"' + fontFamily + '"';
        }
        switch (textAlign) {
          case 'left':
            x = 10;
            y = 20;
            break;
          case 'center':
            x = canvas.width / 2;
            y = 20;
            break;
          case 'right':
            x = canvas.width - 10;
            y = 20;
        }
        paragrafHeight = 0;
        wrapText = function(context, text, x, y, maxWidth, lineHeight) {
          var line, linesCounter, metrics, testLine, testWidth, word, words, _i, _len;
          words = text.split(' ');
          line = '';
          linesCounter = 0;
          for (_i = 0, _len = words.length; _i < _len; _i++) {
            word = words[_i];
            linesCounter = _i + 1;
            testLine = line + word + ' ';
            metrics = context.measureText(testLine);
            testWidth = metrics.width;
            if (testWidth > maxWidth && _i > 0) {
              context.fillText(line, x, y);
              line = word + ' ';
              y += lineHeight;
            } else {
              line = testLine;
            }
            paragrafHeight = y;
          }
          return context.fillText(line, x, y);
        };
        context.font = '1.5em ' + font;
        context.textAlign = textAlign;
        context.fillStyle = '#000';
        context.textBaseline = 'middle';
        context.lineWidth = 1.5;
        wrapText(context, renderInitials(name, surname), x, y, canvas.width - 20, 28);
        context.font = '0.8em ' + font;
        if (textAlign === 'right') {
          x -= 5;
        }
        context.fillText('тел.: ' + phone, x, 32 + paragrafHeight);
        context.fillText('email: ' + eMail, x, 49 + paragrafHeight);
        if (textAlign === 'right') {
          x += 5;
        }
        wrapText(context, position, x, 66 + paragrafHeight, canvas.width - 20, 18);
        return context.save();
      };
      renderInitials = function(name, surname) {
        if (sex === 'male') {
          surname = surname;
        } else if (sex === 'female') {
          if (surname.substr(surname.length - 2, surname.length) === 'ий') {
            surname = surname.slice(0, surname.length - 2);
            surname = surname + 'ая';
          } else {
            surname = surname + 'a';
          }
        }
        return name + ' ' + surname;
      };
      generateRandomCardInfo = function(cardData) {};
      if (cardData.isDefault) {
        cardData;
        randomCardInfo = {
          isDefault: false
        };
        randomNameNum = app.getRandom(0, srcData.names.length - 1);
        randomPhoneEnd = app.getRandom(0, srcData.names.length - 1);
        if (('' + randomPhoneEnd).length < 2) {
          randomPhoneEnd = '0' + randomPhoneEnd;
        }
        randomCardInfo.sex = srcData.names[randomNameNum].sex;
        randomCardInfo.name = srcData.names[randomNameNum].text;
        randomCardInfo.surname = srcData.surnames[app.getRandom(0, srcData.surnames.length - 1)];
        randomCardInfo.eMail = srcData.emails[app.getRandom(0, srcData.emails.length - 1)];
        randomCardInfo.position = srcData.positions[app.getRandom(0, srcData.positions.length - 1)];
        randomCardInfo.phone = '+7-' + srcData.phones + randomPhoneEnd;
        model.set('data', randomCardInfo, {
          silent: true
        });
      }
      if (textOptions.isDefault) {
        randomCardInfo = {
          isDefault: false
        };
        randomCardInfo.textAlign = srcData.textAligns[app.getRandom(0, srcData.textAligns.length - 1)];
        randomCardInfo.fontFamily = '' + fontsList[app.getRandom(0, fontsList.length - 1)];
        WebFont.load({
          custom: {
            families: [randomCardInfo.fontFamily],
            urls: ['/assets/font/card_fonts/' + randomCardInfo.fontFamily + '/' + randomCardInfo.fontFamily + '.css']
          },
          fontloading: (function(_this) {
            return function() {};
          })(this),
          fontactive: (function(_this) {
            return function(fontFamily, fontOptions) {
              return renderText(fontFamily);
            };
          })(this),
          fontinactive: (function(_this) {
            return function() {
              return renderText(fontFamily);
            };
          })(this)
        });
        model.set('generators.textGen', randomCardInfo, {
          silent: true
        });
      } else {
        console.warn('not default!!!');
        renderText(fontFamily);
      }
      return model.set('generators.textGen.isDefault', false, {
        silent: true
      });
    };
  });

}).call(this);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNhcmRzX2dlbmVyYXRvci9nZW5lcmF0b3JzL3RleHQtZ2VuZXJlYXRvci5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQSxNQUFBLGtCQUFBOztBQUFBLEVBQUEsSUFBQyxDQUFBLEdBQUcsQ0FBQyxNQUFMLENBQVksa0NBQVosRUFBZ0QsU0FBQyxPQUFELEVBQVUsR0FBVixFQUFlLFFBQWYsRUFBeUIsVUFBekIsRUFBcUMsQ0FBckMsRUFBd0MsQ0FBeEMsR0FBQTtXQUUvQyxJQUFDLENBQUEsSUFBRCxHQUFRLFNBQUEsR0FBQTtBQUVQLFVBQUEsNk9BQUE7QUFBQSxNQUZRLHVCQUFPLHNCQUFNLDhEQUVyQixDQUFBO0FBQUEsTUFBQSxPQUFBLEdBQVUsR0FBRyxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsR0FBdkIsQ0FBMkIsU0FBM0IsQ0FBVixDQUFBO0FBQUEsTUFDQSxPQUFPLENBQUMsVUFBUixHQUFxQixDQUFDLE1BQUQsRUFBUSxRQUFSLEVBQWlCLE9BQWpCLENBRHJCLENBQUE7QUFBQSxNQUVBLFNBQUEsR0FBWSxHQUFHLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxHQUF2QixDQUEyQixXQUEzQixDQUZaLENBQUE7QUFBQSxNQUdBLFdBQUEsR0FBYyxLQUFLLENBQUMsR0FBTixDQUFVLG9CQUFWLENBSGQsQ0FBQTtBQUFBLE1BSUEsUUFBQSxHQUFXLEtBQUssQ0FBQyxHQUFOLENBQVUsTUFBVixDQUpYLENBQUE7QUFBQSxNQU9BLElBQUEsR0FBTyxRQUFRLENBQUMsSUFQaEIsQ0FBQTtBQUFBLE1BUUEsT0FBQSxHQUFVLFFBQVEsQ0FBQyxPQVJuQixDQUFBO0FBQUEsTUFTQSxHQUFBLEdBQU0sUUFBUSxDQUFDLEdBVGYsQ0FBQTtBQUFBLE1BVUEsS0FBQSxHQUFRLFFBQVEsQ0FBQyxLQVZqQixDQUFBO0FBQUEsTUFXQSxLQUFBLEdBQVEsUUFBUSxDQUFDLEtBWGpCLENBQUE7QUFBQSxNQVlBLFFBQUEsR0FBVyxRQUFR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cmRzX2dlbmVyYXRvci9nZW5lcmF0b3JzL3RleHQtZ2VuZXJlYXRvci5qcyIsInNvdXJjZVJvb3QiOiIvc291cmNlLyIsInNvdXJjZXNDb250ZW50IjpbIkBhcHAubW9kdWxlICdDYXJkR2VuZXJhdG9yLmdlbmVyYXRvcnMudGV4dEdlbicsIChUZXh0R2VuLCBhcHAsIEJhY2tib25lLCBNYXJpb25ldHRlLCAkLCBfKSAtPlxuXHQjIFRPRE8gbWFrZSB0ZXh0IHJlbmRlcmluZyB3aXRoIG91dCB0cmlnZ2VyaW5nIFJlc2l6ZSAoeWVzLCBpdCBpcyBwb3NpYmxlKVxuXHRAZHJhdyA9IChjYW52YXMsbW9kZWwsYXJncy4uLikgLT5cblx0XHQjIGdldCBjdXJyZW50IHRleHQgcHRpb25zIGFuZCBjYXJkIGluZm8gZnJvbSBtb2RlbFxuXHRcdHNyY0RhdGEgPSBhcHAuQ2FyZEdlbmVyYXRvci5kYXRhLmdldCAnYXBwZGF0YSdcblx0XHRzcmNEYXRhLnRleHRBbGlnbnMgPSBbJ2xlZnQnLCdjZW50ZXInLCdyaWdodCddXG5cdFx0Zm9udHNMaXN0ID0gYXBwLkNhcmRHZW5lcmF0b3IuZGF0YS5nZXQgJ2ZvbnRzTGlzdCdcblx0XHR0ZXh0T3B0aW9ucyA9IG1vZGVsLmdldCAnZ2VuZXJhdG9ycy50ZXh0R2VuJ1xuXHRcdGNhcmREYXRhID0gbW9kZWwuZ2V0ICdkYXRhJ1xuXHRcdFxuXHRcdCMgY2FyZCBpbmZvXG5cdFx0bmFtZSA9IGNhcmREYXRhLm5hbWVcblx0XHRzdXJuYW1lID0gY2FyZERhdGEuc3VybmFtZVxuXHRcdHNleCA9IGNhcmREYXRhLnNleFxuXHRcdHBob25lID0gY2FyZERhdGEucGhvbmVcblx0XHRlTWFpbCA9IGNhcmREYXRhLmVNYWlsXG5cdFx0cG9zaXRpb24gPSBjYXJkRGF0YS5wb3NpdGlvblxuXHRcdFxuXHRcdCMgdGV4dCBwdGlvbnNcblx0XHR0ZXh0QWxpZ24gPSB0ZXh0T3B0aW9ucy50ZXh0QWxpZ25cblx0XHRmb250RmFtaWx5ID0gdGV4dE9wdGlvbnMuZm9udEZhbWlseVxuXG5cdFx0Y29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpXG5cblx0XHRyZW5kZXJUZXh0ID0gKGZvbnRGYW1pbHkpIC0+XG5cdFx0XHRjb25zb2xlLmxvZyAncmVuZGVyJ1xuXHRcdFx0Zm9udEZhbWlseSA9ICdzYW5zLXNlcmlmJ1xuXHRcdFx0aWYgZm9udEZhbWlseSBpcyAnc2Fucy1zZXJpZidcblx0XHRcdFx0Zm9udCA9IGZvbnRGYW1pbHlcblx0XHRcdGVsc2UgXG5cdFx0XHRcdGZvbnQgPSAnXCInK2ZvbnRGYW1pbHkrJ1wiJ1xuXHRcdFx0c3dpdGNoIHRleHRBbGlnblxuXHRcdFx0XHR3aGVuICdsZWZ0J1xuXHRcdFx0XHRcdHggPSAxMFxuXHRcdFx0XHRcdHkgPSAyMFxuXHRcdFx0XHR3aGVuICdjZW50ZXInIFxuXHRcdFx0XHRcdHggPSBjYW52YXMud2lkdGgvMlxuXHRcdFx0XHRcdHkgPSAyMFxuXHRcdFx0XHR3aGVuICdyaWdodCdcblx0XHRcdFx0XHR4ID0gY2FudmFzLndpZHRoLTEwXG5cdFx0XHRcdFx0eSA9IDIwIFxuXHRcdFx0cGFyYWdyYWZIZWlnaHQgPSAwXG5cdFx0XHRcblx0XHRcdHdyYXBUZXh0ID0gKGNvbnRleHQsIHRleHQsIHgsIHksIG1heFdpZHRoLCBsaW5lSGVpZ2h0KSAtPlxuXHRcdFx0XHR3b3JkcyA9IHRleHQuc3BsaXQoJyAnKVxuXHRcdFx0XHRsaW5lID0gJydcblx0XHRcdFx0bGluZXNDb3VudGVyID0gMFxuXHRcdFx0XHRmb3Igd29yZCBpbiB3b3Jkc1xuXHRcdFx0XHRcdCMgY29uc29sZS5sb2cgd29yZCxfaVxuXHRcdFx0XHRcdGxpbmVzQ291bnRlciA9IF9pKzFcblx0XHRcdFx0XHR0ZXN0TGluZSA9IGxpbmUgKyB3b3JkICsgJyAnXG5cdFx0XHRcdFx0bWV0cmljcyA9IGNvbnRleHQubWVhc3VyZVRleHQodGVzdExpbmUpXG5cdFx0XHRcdFx0dGVzdFdpZHRoID0gbWV0cmljcy53aWR0aFxuXHRcdFx0XHRcdGlmICB0ZXN0V2lkdGggPiBtYXhXaWR0aCBhbmQgX2kgPiAwXG5cdFx0XHRcdFx0XHRjb250ZXh0LmZpbGxUZXh0KGxpbmUsIHgsIHkpXG5cdFx0XHRcdFx0XHRsaW5lID0gd29yZCArICcgJ1xuXHRcdFx0XHRcdFx0eSArPSBsaW5lSGVpZ2h0XG5cdFx0XHRcdFx0ZWxzZVxuXHRcdFx0XHRcdFx0bGluZSA9IHRlc3RMaW5lXG5cdFx0XHRcdFx0cGFyYWdyYWZIZWlnaHQgPSB5XG5cdFx0XHRcdFx0XG5cdFx0XHRcdGNvbnRleHQuZmlsbFRleHQobGluZSwgeCwgeSlcblx0XHRcdGNvbnRleHQuZm9udCA9ICcxLjVlbSAnICsgZm9udFxuXHRcdFx0Y29udGV4dC50ZXh0QWxpZ24gPSB0ZXh0QWxpZ25cblx0XHRcdGNvbnRleHQuZmlsbFN0eWxlID0gJyMwMDAnXG5cdFx0XHRjb250ZXh0LnRleHRCYXNlbGluZSA9ICdtaWRkbGUnXG5cdFx0XHRjb250ZXh0LmxpbmVXaWR0aCA9IDEuNVxuXG5cdFx0XHR3cmFwVGV4dCBjb250ZXh0ICwgcmVuZGVySW5pdGlhbHMobmFtZSwgc3VybmFtZSksIHgsIHksIGNhbnZhcy53aWR0aC0yMCwgMjhcblxuXHRcdFx0Y29udGV4dC5mb250ID0gJzAuOGVtICcgKyBmb250XG5cdFx0XHQjIGNvbnNvbGUubG9nICdjYXJkIOKElicgKyBtb2RlbC5nZXQoJ2lkJykgKyAnIDogJyArIGZvbnQuc3BsaXQoJ1wiJykuam9pbignJylcblx0XHRcdGlmIHRleHRBbGlnbiBpcyAncmlnaHQnIHRoZW4geC09NVxuXHRcdFx0Y29udGV4dC5maWxsVGV4dCAn0YLQtdC7LjogJyArIHBob25lLCB4LCAzMiArcGFyYWdyYWZIZWlnaHRcblx0XHRcdGNvbnRleHQuZmlsbFRleHQgJ2VtYWlsOiAnKyBlTWFpbCwgeCwgNDkgK3BhcmFncmFmSGVpZ2h0XG5cdFx0XHRpZiB0ZXh0QWxpZ24gaXMgJ3JpZ2h0JyB0aGVuIHgrPTVcblx0XHRcdHdyYXBUZXh0IGNvbnRleHQgLCBwb3NpdGlvbiwgeCwgNjYgKyBwYXJhZ3JhZkhlaWdodCwgY2FudmFzLndpZHRoLTIwLCAxOFxuXG5cdFx0XHRjb250ZXh0LnNhdmUoKVxuXG5cdFx0IyBnZW5lcmF0ZVJhbmRvbUNhcmRJbmZvXG5cdFx0cmVuZGVySW5pdGlhbHMgPSAobmFtZSwgc3VybmFtZSkgLT5cblxuXHRcdFx0aWYgc2V4IGlzICdtYWxlJ1xuXHRcdFx0XHRzdXJuYW1lID0gc3VybmFtZVxuXG5cdFx0XHRlbHNlIGlmIHNleCBpcyAnZmVtYWxlJ1xuXHRcdFx0XHRpZiBzdXJuYW1lLnN1YnN0cihzdXJuYW1lLmxlbmd0aC0yLHN1cm5hbWUubGVuZ3RoKSBpcyAn0LjQuSdcblx0XHRcdFx0XHRzdXJuYW1lID0gc3VybmFtZS5zbGljZSgwLHN1cm5hbWUubGVuZ3RoLTIpXG5cdFx0XHRcdFx0c3VybmFtZSA9IHN1cm5hbWUrJ9Cw0Y8nXG5cdFx0XHRcdGVsc2Vcblx0XHRcdFx0XHRzdXJuYW1lID0gc3VybmFtZSsnYScgXG5cdFx0XHRuYW1lICsgJyAnICsgc3VybmFtZVx0XHRcdFx0XHRcblx0XHRnZW5lcmF0ZVJhbmRvbUNhcmRJbmZvID0gKGNhcmREYXRhKSAtPlxuXG5cdFx0aWYgY2FyZERhdGEuaXNEZWZhdWx0XG5cdFx0XHRjYXJkRGF0YVxuXHRcdFx0IyBjb25zb2xlLmxvZyAnY2FyZERhdGEgZGVmYXVsdCdcblx0XHRcdCNhZGQgYWxsIG5ldyB2YWx1ZXMgdG8gdGhpcyBvYmplY3Rcblx0XHRcdHJhbmRvbUNhcmRJbmZvID1cblx0XHRcdFx0aXNEZWZhdWx0OiBmYWxzZVxuXG5cdFx0XHQjbG9jYWwgdmFyaWFibGVzXG5cdFx0XHRyYW5kb21OYW1lTnVtID0gYXBwLmdldFJhbmRvbSgwLCBzcmNEYXRhLm5hbWVzLmxlbmd0aC0xIClcblx0XHRcdHJhbmRvbVBob25lRW5kID0gYXBwLmdldFJhbmRvbSgwLCBzcmNEYXRhLm5hbWVzLmxlbmd0aC0xIClcblx0XHRcdHJhbmRvbVBob25lRW5kID0gJzAnICsgcmFuZG9tUGhvbmVFbmQgaWYgKCcnKyByYW5kb21QaG9uZUVuZCkubGVuZ3RoIDwgMiBcblx0XHRcdCNlbmQgbG9jYWwgdmFyaWFibGVzXG5cblx0XHRcdHJhbmRvbUNhcmRJbmZvLnNleCA9IHNyY0RhdGEubmFtZXNbIHJhbmRvbU5hbWVOdW0gXS5zZXhcblx0XHRcdHJhbmRvbUNhcmRJbmZvLm5hbWUgPSAgc3JjRGF0YS5uYW1lc1sgcmFuZG9tTmFtZU51bSBdLnRleHRcblx0XHRcdHJhbmRvbUNhcmRJbmZvLnN1cm5hbWUgPSAgc3JjRGF0YS5zdXJuYW1lc1sgYXBwLmdldFJhbmRvbSgwLCBzcmNEYXRhLnN1cm5hbWVzLmxlbmd0aC0xICkgXVxuXHRcdFx0cmFuZG9tQ2FyZEluZm8uZU1haWwgPSAgc3JjRGF0YS5lbWFpbHNbIGFwcC5nZXRSYW5kb20oMCwgc3JjRGF0YS5lbWFpbHMubGVuZ3RoLTEgKSBdXG5cdFx0XHRyYW5kb21DYXJkSW5mby5wb3NpdGlvbiA9ICBzcmNEYXRhLnBvc2l0aW9uc1sgYXBwLmdldFJhbmRvbSgwLCBzcmNEYXRhLnBvc2l0aW9ucy5sZW5ndGgtMSApIF1cblx0XHRcdHJhbmRvbUNhcmRJbmZvLnBob25lID0gJys3LScgKyBzcmNEYXRhLnBob25lcyArIHJhbmRvbVBob25lRW5kXG5cblx0XHRcdCMgc2V0IG5ldyBjYXJkIGluZm8gdG8gbW9kZWxcblx0XHRcdG1vZGVsLnNldCAnZGF0YScsIHJhbmRvbUNhcmRJbmZvLFxuXHRcdFx0XHRzaWxlbnQ6IHRydWVcblxuXHRcdGlmIHRleHRPcHRpb25zLmlzRGVmYXVsdFxuXHRcdFx0IyBjb25zb2xlLmxvZyAndGV4dE9wdGlvbnMgZGVmYXVsdCcsIHRleHRPcHRpb25zXG5cdFx0XHRyYW5kb21DYXJkSW5mbyA9XG5cdFx0XHRcdGlzRGVmYXVsdDogZmFsc2VcblxuXHRcdFx0I2xvY2FsIHZhcmlhYmxlc1xuXHRcdFx0I2VuZCBsb2NhbCB2YXJpYWJsZXNcblxuXHRcdFx0cmFuZG9tQ2FyZEluZm8udGV4dEFsaWduID0gc3JjRGF0YS50ZXh0QWxpZ25zW2FwcC5nZXRSYW5kb20oMCxzcmNEYXRhLnRleHRBbGlnbnMubGVuZ3RoLTEpXVxuXHRcdFx0cmFuZG9tQ2FyZEluZm8uZm9udEZhbWlseSA9ICcnKyBmb250c0xpc3RbIGFwcC5nZXRSYW5kb20oMCwgZm9udHNMaXN0Lmxlbmd0aC0xKSBdXG5cdFx0XHQjIGRlYnVnZ2VyO1xuXG5cdFx0XHQjIExvYWQgZm9udHMgZGluYW1pY2FseSB0aHJvdWdoIGdvb2dsZSB3ZWIgbG9hZGVyXG5cdFx0XHRXZWJGb250LmxvYWRcblx0XHRcdFx0Y3VzdG9tOlxuXHRcdFx0XHRcdGZhbWlsaWVzOiBbcmFuZG9tQ2FyZEluZm8uZm9udEZhbWlseV1cblx0XHRcdFx0XHR1cmxzOiBbJy9hc3NldHMvZm9udC9jYXJkX2ZvbnRzLycgKyByYW5kb21DYXJkSW5mby5mb250RmFtaWx5ICsgJy8nICsgcmFuZG9tQ2FyZEluZm8uZm9udEZhbWlseSArICcuY3NzJ11cblx0XHRcdFx0Zm9udGxvYWRpbmc6ICA9PlxuXHRcdFx0XHRcdCMgY29uc29sZS5sb2cgJ2ZvbnRsb2FkaW5nOlxcdCcsIGFyZ3VtZW50c1xuXHRcdFx0XHRmb250YWN0aXZlOiAoZm9udEZhbWlseSwgZm9udE9wdGlvbnMpICA9PlxuXHRcdFx0XHRcdCMgY29uc29sZS5sb2cgJ2ZvbnRhY3RpdmU6XFx0IFxcdCcsIGZvbnRGYW1pbHlcblx0XHRcdFx0XHRyZW5kZXJUZXh0KGZvbnRGYW1pbHkpXG5cdFx0XHRcdGZvbnRpbmFjdGl2ZTogID0+XG5cdFx0XHRcdFx0IyBjb25zb2xlLmxvZyAnZm9udGluYWN0aXZlOlxcdCBcXHQnLCBhcmd1bWVudHNcblx0XHRcdFx0XHRyZW5kZXJUZXh0KCBmb250RmFtaWx5IClcblx0XHRcdCMgc2V0IG5ldyBjYXJkIGluZm8gdG8gbW9kZWxcblx0XHRcdG1vZGVsLnNldCAnZ2VuZXJhdG9ycy50ZXh0R2VuJywgcmFuZG9tQ2FyZEluZm8sXG5cdFx0XHRcdHNpbGVudDogdHJ1ZVxuXG5cdFx0ZWxzZSBcblx0XHRcdGNvbnNvbGUud2FybiAnbm90IGRlZmF1bHQhISEnXG5cdFx0XHRyZW5kZXJUZXh0KGZvbnRGYW1pbHkpXG5cblx0XHRtb2RlbC5zZXQgJ2dlbmVyYXRvcnMudGV4dEdlbi5pc0RlZmF1bHQnLCBmYWxzZSxcblx0XHRcdHNpbGVudDogdHJ1ZSJdfQ==